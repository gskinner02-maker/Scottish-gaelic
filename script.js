// -----------------------------
// FUTURE VERB LISTS
// -----------------------------
let futureRegular = [
    { gaelic: "seinnidh mi", english: "I will sing", form: "positive" },
    { gaelic: "cha seinn mi", english: "I will not sing", form: "negative" },
    { gaelic: "an seinn mi?", english: "Will I sing?", form: "question" },

    { gaelic: "cha choisich mi", english: "I will not walk", form: "negative" },
    { gaelic: "an coisich mi?", english: "Will I walk?", form: "question" },

    { gaelic: "ruithidh mi", english: "I will run", form: "positive" },
    { gaelic: "cha ruith mi", english: "I will not run", form: "negative" },
    { gaelic: "an ruith mi?", english: "Will I run?", form: "question" },

    { gaelic: "cluichidh mi", english: "I will play", form: "positive" },
    { gaelic: "cha cluich mi", english: "I will not play", form: "negative" },
    { gaelic: "an cluich mi?", english: "Will I play?", form: "question" },

    { gaelic: "èistidh mi", english: "I will listen", form: "positive" },
    { gaelic: "cha èist mi", english: "I will not listen", form: "negative" },
    { gaelic: "an èist mi?", english: "Will I listen?", form: "question" },

    { gaelic: "sgrìobhaidh mi", english: "I will write", form: "positive" },
    { gaelic: "cha sgrìobh mi", english: "I will not write", form: "negative" },
    { gaelic: "an sgrìobh mi?", english: "Will I write?", form: "question" },

    { gaelic: "leughaidh mi", english: "I will read", form: "positive" },
    { gaelic: "cha leugh mi", english: "I will not read", form: "negative" },
    { gaelic: "an leugh mi?", english: "Will I read?", form: "question" },

    { gaelic: "ceannaichidh mi", english: "I will buy", form: "positive" },
    { gaelic: "cha cheannaich mi", english: "I will not buy", form: "negative" },
    { gaelic: "an ceannaich mi?", english: "Will I buy?", form: "question" },

    { gaelic: "coinnichidh mi", english: "I will meet", form: "positive" },
    { gaelic: "cha choinnich mi", english: "I will not meet", form: "negative" },
    { gaelic: "an coinnich mi?", english: "Will I meet?", form: "question" },

    { gaelic: "còcaichidh mi", english: "I will cook", form: "positive" },
    { gaelic: "cha chòcaich mi", english: "I will not cook", form: "negative" },
    { gaelic: "an còcaich mi?", english: "Will I cook?", form: "question" },

    { gaelic: "ithidh mi", english: "I will eat", form: "positive" },
    { gaelic: "cha ith mi", english: "I will not eat", form: "negative" },
    { gaelic: "an ith mi?", english: "Will I eat?", form: "question" }
];

let futureIrregular = [
    { gaelic: "thèid mi", english: "I will go", form: "positive" },
    { gaelic: "cha tèid mi", english: "I will not go", form: "negative" },
    { gaelic: "an tèid mi?", english: "Will I go?", form: "question" },

    { gaelic: "thig mi", english: "I will come", form: "positive" },
    { gaelic: "cha tig mi", english: "I will not come", form: "negative" },
    { gaelic: "an tig mi?", english: "Will I come?", form: "question" },

    { gaelic: "nì mi", english: "I will do", form: "positive" },
    { gaelic: "cha dèan mi", english: "I will not do", form: "negative" },
    { gaelic: "an dèan mi?", english: "Will I do?", form: "question" },

    { gaelic: "chì mi", english: "I will see", form: "positive" },
    { gaelic: "chan fhaic mi", english: "I will not see", form: "negative" },
    { gaelic: "am faic mi?", english: "Will I see?", form: "question" },

    { gaelic: "their mi", english: "I will say", form: "positive" },
    { gaelic: "chan abair mi", english: "I will not say", form: "negative" },
    { gaelic: "an abair mi?", english: "Will I say?", form: "question" },

    { gaelic: "gheibh mi", english: "I will get", form: "positive" },
    { gaelic: "chan fhaigh mi", english: "I will not get", form: "negative" },
    { gaelic: "am fhaigh mi?", english: "Will I get?", form: "question" },

    { gaelic: "bheir mi", english: "I will give", form: "positive" },
    { gaelic: "cha toir mi", english: "I will not give", form: "negative" },
    { gaelic: "an toir mi?", english: "Will I give?", form: "question" },

    { gaelic: "clunnidh mi", english: "I will hear", form: "positive" },
    { gaelic: "cha chluinn mi", english: "I will not hear", form: "negative" },
    { gaelic: "an cluinn mi?", english: "Will I hear?", form: "question" },

    { gaelic: "beiridh mi", english: "I will catch", form: "positive" },
    { gaelic: "cha bheir mi", english: "I will not catch", form: "negative" },
    { gaelic: "am beir mi?", english: "Will I catch?", form: "question" },

    { gaelic: "ruigidh mi", english: "I will reach", form: "positive" },
    { gaelic: "cha ruig mi", english: "I will not reach", form: "negative" },
    { gaelic: "an ruig mi?", english: "Will I reach?", form: "question" },

    { gaelic: "bidh mi", english: "I will be", form: "positive" },
    { gaelic: "cha bhi mi", english: "I will not be", form: "negative" },
    { gaelic: "am bi mi?", english: "Will I be?", form: "question" }
];

// -----------------------------
// PRESENT VERB LISTS
// -----------------------------
let presentRegular = [
    { gaelic: "tha mi a’ seinn", english: "I am singing", form: "positive" },
    { gaelic: "chan eil mi a’ seinn", english: "I am not singing", form: "negative" },
    { gaelic: "a bheil mi a’ seinn?", english: "Am I singing?", form: "question" },

    { gaelic: "tha mi a’ coiseachd", english: "I am walking", form: "positive" },
    { gaelic: "chan eil mi a’ coiseachd", english: "I am not walking", form: "negative" },
    { gaelic: "a bheil mi a’ coiseachd?", english: "Am I walking?", form: "question" },

    { gaelic: "tha mi a’ ruith", english: "I am running", form: "positive" },
    { gaelic: "chan eil mi a’ ruith", english: "I am not running", form: "negative" },
    { gaelic: "a bheil mi a’ ruith?", english: "Am I running?", form: "question" },

    { gaelic: "tha mi a’ cluich", english: "I am playing", form: "positive" },
    { gaelic: "chan eil mi a’ cluich", english: "I am not playing", form: "negative" },
    { gaelic: "a bheil mi a’ cluich?", english: "Am I playing?", form: "question" },

    { gaelic: "tha mi ag èisteachd", english: "I am listening", form: "positive" },
    { gaelic: "chan eil mi ag èisteachd", english: "I am not listening", form: "negative" },
    { gaelic: "a bheil mi ag èisteachd?", english: "Am I listening?", form: "question" },

    { gaelic: "tha mi a’ sgrìobhadh", english: "I am writing", form: "positive" },
    { gaelic: "chan eil mi a’ sgrìobhadh", english: "I am not writing", form: "negative" },
    { gaelic: "a bheil mi a’ sgrìobhadh?", english: "Am I writing?", form: "question" },

    { gaelic: "tha mi a’ leughadh", english: "I am reading", form: "positive" },
    { gaelic: "chan eil mi a’ leughadh", english: "I am not reading", form: "negative" },
    { gaelic: "a bheil mi a’ leughadh?", english: "Am I reading?", form: "question" },

    { gaelic: "tha mi a’ ceannach", english: "I am buying", form: "positive" },
    { gaelic: "chan eil mi a’ ceannach", english: "I am not buying", form: "negative" },
    { gaelic: "a bheil mi a’ ceannach?", english: "Am I buying?", form: "question" },

    { gaelic: "tha mi a’ coinneachadh", english: "I am meeting", form: "positive" },
    { gaelic: "chan eil mi a’ coinneachadh", english: "I am not meeting", form: "negative" },
    { gaelic: "a bheil mi a’ coinneachadh?", english: "Am I meeting?", form: "question" },

    { gaelic: "tha mi a’ còcaireachd", english: "I am cooking", form: "positive" },
    { gaelic: "chan eil mi a’ còcaireachd", english: "I am not cooking", form: "negative" },
    { gaelic: "a bheil mi a’ còcaireachd?", english: "Am I cooking?", form: "question" },

    { gaelic: "tha mi ag ithe", english: "I am eating", form: "positive" },
    { gaelic: "chan eil mi ag ithe", english: "I am not eating", form: "negative" },
    { gaelic: "a bheil mi ag ithe?", english: "Am I eating?", form: "question" }
];

let presentIrregular = [
    { gaelic: "tha mi", english: "I am", form: "positive" },
    { gaelic: "chan eil mi", english: "I am not", form: "negative" },
    { gaelic: "a bheil mi?", english: "Am I?", form: "question" },

    { gaelic: "tha mi a’ dol", english: "I am going", form: "positive" },
    { gaelic: "chan eil mi a’ dol", english: "I am not going", form: "negative" },
    { gaelic: "a bheil mi a’ dol?", english: "Am I going?", form: "question" },

    { gaelic: "tha mi a’ tighinn", english: "I am coming", form: "positive" },
    { gaelic: "chan eil mi a’ tighinn", english: "I am not coming", form: "negative" },
    { gaelic: "a bheil mi a’ tighinn?", english: "Am I coming?", form: "question" },

    { gaelic: "tha mi a’ dèanamh", english: "I am doing", form: "positive" },
    { gaelic: "chan eil mi a’ dèanamh", english: "I am not doing", form: "negative" },
    { gaelic: "a bheil mi a’ dèanamh?", english: "Am I doing?", form: "question" },

    { gaelic: "tha mi a’ faicinn", english: "I am seeing", form: "positive" },
    { gaelic: "chan eil mi a’ faicinn", english: "I am not seeing", form: "negative" },
    { gaelic: "a bheil mi a’ faicinn?", english: "Am I seeing?", form: "question" },

    { gaelic: "tha mi ag ràdh", english: "I am saying", form: "positive" },
    { gaelic: "chan eil mi ag ràdh", english: "I am not saying", form: "negative" },
    { gaelic: "a bheil mi ag ràdh?", english: "Am I saying?", form: "question" },

    { gaelic: "tha mi a’ faighinn", english: "I am getting", form: "positive" },
    { gaelic: "chan eil mi a’ faighinn", english: "I am not getting", form: "negative" },
    { gaelic: "a bheil mi a’ faighinn?", english: "Am I getting?", form: "question" },

    { gaelic: "tha mi a’ toirt", english: "I am giving", form: "positive" },
    { gaelic: "chan eil mi a’ toirt", english: "I am not giving", form: "negative" },
    { gaelic: "a bheil mi a’ toirt?", english: "Am I giving?", form: "question" }
];
// -----------------------------
// PAST REGULAR
// -----------------------------
let pastRegular = [
    // sing
    { gaelic: "sheinn mi", english: "I sang", form: "positive" },
    { gaelic: "cha do sheinn mi", english: "I did not sing", form: "negative" },
    { gaelic: "an do sheinn mi?", english: "Did I sing?", form: "question" },

    // walk
    { gaelic: "choisich mi", english: "I walked", form: "positive" },
    { gaelic: "cha do choisich mi", english: "I did not walk", form: "negative" },
    { gaelic: "an do choisich mi?", english: "Did I walk?", form: "question" },

    // work
    { gaelic: "dh’obraich mi", english: "I worked", form: "positive" },
    { gaelic: "cha do dh’obraich mi", english: "I did not work", form: "negative" },
    { gaelic: "an do dh’obraich mi?", english: "Did I work?", form: "question" },

    // play
    { gaelic: "chluich mi", english: "I played", form: "positive" },
    { gaelic: "cha do chluich mi", english: "I did not play", form: "negative" },
    { gaelic: "an do chluich mi?", english: "Did I play?", form: "question" },

    // learn
    { gaelic: "dh’ionnsaich mi", english: "I learned", form: "positive" },
    { gaelic: "cha do dh’ionnsaich mi", english: "I did not learn", form: "negative" },
    { gaelic: "an do dh’ionnsaich mi?", english: "Did I learn?", form: "question" },

    // stay
    { gaelic: "dh’fhuirich mi", english: "I stayed", form: "positive" },
    { gaelic: "cha do dh’fhuirich mi", english: "I did not stay", form: "negative" },
    { gaelic: "an do dh’fhuirich mi?", english: "Did I stay?", form: "question" },

    // open
    { gaelic: "dh’fhosgail mi", english: "I opened", form: "positive" },
    { gaelic: "cha do dh’fhosgail mi", english: "I did not open", form: "negative" },
    { gaelic: "an do dh’fhosgail mi?", english: "Did I open?", form: "question" },

    // close
    { gaelic: "dhùin mi", english: "I closed", form: "positive" },
    { gaelic: "cha do dhùin mi", english: "I did not close", form: "negative" },
    { gaelic: "an do dhùin mi?", english: "Did I close?", form: "question" },

    // watch
    { gaelic: "choimhead mi", english: "I watched", form: "positive" },
    { gaelic: "cha do choimhead mi", english: "I did not watch", form: "negative" },
    { gaelic: "an do choimhead mi?", english: "Did I watch?", form: "question" },

    // help
    { gaelic: "chuidich mi", english: "I helped", form: "positive" },
    { gaelic: "cha do chuidich mi", english: "I did not help", form: "negative" },
    { gaelic: "an do chuidich mi?", english: "Did I help?", form: "question" }
];

let pastIrregular = [
    { gaelic: "chaidh mi", english: "I went", form: "positive" },
    { gaelic: "cha deach mi", english: "I did not go", form: "negative" },
    { gaelic: "an deach mi?", english: "Did I go?", form: "question" },

    { gaelic: "thàinig mi", english: "I came", form: "positive" },
    { gaelic: "cha tàinig mi", english: "I did not come", form: "negative" },
    { gaelic: "an tàinig mi?", english: "Did I come?", form: "question" },

    { gaelic: "rinn mi", english: "I did", form: "positive" },
    { gaelic: "cha do rinn mi", english: "I did not do", form: "negative" },
    { gaelic: "an do rinn mi?", english: "Did I do?", form: "question" },

    { gaelic: "chunnaic mi", english: "I saw", form: "positive" },
    { gaelic: "cha do chunnaic mi", english: "I did not see", form: "negative" },
    { gaelic: "an do chunnaic mi?", english: "Did I see?", form: "question" },
        
    { gaelic: "thuirt mi", english: "I said", form: "positive" },
    { gaelic: "cha tuirt mi", english: "I did not say", form: "negative" },
    { gaelic: "an tuirt mi?", english: "Did I say?", form: "question" },

    { gaelic: "fhuair mi", english: "I got", form: "positive" },
    { gaelic: "cha d’ fhuair mi", english: "I did not get", form: "negative" },
    { gaelic: "an d’ fhuair mi?", english: "Did I get?", form: "question" },

    { gaelic: "thug mi", english: "I gave", form: "positive" },
    { gaelic: "cha do thug mi", english: "I did not give", form: "negative" },
    { gaelic: "an do thug mi?", english: "Did I give?", form: "question" }
];
// -----------------------------
// STATE
// -----------------------------
let currentCategory = null;
let currentForm = null;
let savedForm = null;
let currentList = [];
let typeIndex = 0;
let editorTarget = "";

// -----------------------------
// HELPERS
// -----------------------------
function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
}

function setCurrentList() {
    let baseList = [];

    if (currentCategory === "regular") baseList = futureRegular;
    else if (currentCategory === "irregular") baseList = futureIrregular;

    else if (currentCategory === "presentRegular") baseList = presentRegular;
    else if (currentCategory === "presentIrregular") baseList = presentIrregular;

    else if (currentCategory === "pastRegular") baseList = pastRegular;
    else if (currentCategory === "pastIrregular") baseList = pastIrregular;

    // Mixed and Type modes both use the full list
    if (currentForm === "mixed" || currentForm === "type") {
        currentList = [...baseList];
    } else {
        currentList = baseList.filter(item => item.form === currentForm);
    }
}

// -----------------------------
// HIDE EVERYTHING
// -----------------------------
function hideAll() {
    const ids = [
        "mainMenu", "futureMenu", "regularMenu", "irregularMenu",
        "presentMenu", "presentRegular", "presentIrregular",
        "pastMenu", "pastRegular", "pastIrregular",
        "formMenu", "study", "play", "typeAnswer",
        "presentRegularEditor", "presentIrregularEditor",
        "pastRegularEditor", "pastIrregularEditor",
        "regularEditor", "irregularEditor"
    ];

    ids.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.classList.add("hidden");
    });
}

// -----------------------------
// MAIN MENU
// -----------------------------
function showMainMenu() {
    hideAll();
    document.getElementById("mainMenu").classList.remove("hidden");
}

// -----------------------------
// FUTURE MENUS
// -----------------------------
function openFutureMenu() {
    hideAll();
    document.getElementById("futureMenu").classList.remove("hidden");
}

function openRegularMenu() {
    hideAll();
    document.getElementById("regularMenu").classList.remove("hidden");
}

function openIrregularMenu() {
    hideAll();
    document.getElementById("irregularMenu").classList.remove("hidden");
}

// -----------------------------
// PRESENT MENUS
// -----------------------------
function openPresentMenu() {
    hideAll();
    document.getElementById("presentMenu").classList.remove("hidden");
}

function openPresentRegular() {
    hideAll();
    document.getElementById("presentRegular").classList.remove("hidden");
}

function openPresentIrregular() {
    hideAll();
    document.getElementById("presentIrregular").classList.remove("hidden");
}

// -----------------------------
// PAST MENUS
// -----------------------------
function openPastMenu() {
    hideAll();
    document.getElementById("pastMenu").classList.remove("hidden");
}

function openPastRegular() {
    hideAll();
    document.getElementById("pastRegular").classList.remove("hidden");
}

function openPastIrregular() {
    hideAll();
    document.getElementById("pastIrregular").classList.remove("hidden");
}

// -----------------------------
// CHOOSE FORM (positive/negative/question)
// -----------------------------
function chooseForm(category, form) {
    currentCategory = category;
    currentForm = form;
    setCurrentList();

    let tense = "Future";
    if (category.startsWith("present")) tense = "Present";
    if (category.startsWith("past")) tense = "Past";

    let catLabel = category.includes("Irregular") ? "Irregular" : "Regular";
    let formLabel = form.charAt(0).toUpperCase() + form.slice(1);

    hideAll();
    document.getElementById("formMenuTitle").textContent =
        `${catLabel} – ${formLabel} (${tense} Tense)`;
    document.getElementById("formMenu").classList.remove("hidden");
}

// -----------------------------
// MIXED (10)
// -----------------------------
function chooseMixed(category) {
    currentCategory = category;
    currentForm = "mixed";

    if (category === "regular") currentList = shuffle([...futureRegular]).slice(0, 10);
    else if (category === "irregular") currentList = shuffle([...futureIrregular]).slice(0, 10);
    else if (category === "presentRegular") currentList = shuffle([...presentRegular]).slice(0, 10);
    else if (category === "presentIrregular") currentList = shuffle([...presentIrregular]).slice(0, 10);
    else if (category === "pastRegular") currentList = shuffle([...pastRegular]).slice(0, 10);
    else if (category === "pastIrregular") currentList = shuffle([...pastIrregular]).slice(0, 10);

    hideAll();
    document.getElementById("formMenuTitle").textContent = "Mixed Forms (10)";
    document.getElementById("formMenu").classList.remove("hidden");
}

// -----------------------------
// DAILY 10
// -----------------------------
function startDaily10() {

    let allVerbs = [
    ...(Array.isArray(futureRegular) ? futureRegular : []),
    ...(Array.isArray(futureIrregular) ? futureIrregular : []),
    ...(Array.isArray(presentRegular) ? presentRegular : []),
    ...(Array.isArray(presentIrregular) ? presentIrregular : []),
    ...(Array.isArray(pastRegular) ? pastRegular : []),
    ...(Array.isArray(pastIrregular) ? pastIrregular : [])
];


    currentList = shuffle([...allVerbs]).slice(0, 10);
    currentCategory = "daily10";
    currentForm = "mixed";
    lastMenu = "mainMenu";

    hideAll();
    document.getElementById("formMenuTitle").textContent = "Daily 10 (All Tenses)";
    document.getElementById("formMenu").classList.remove("hidden");
}

// -----------------------------
// BACK FROM FORM MENU
// -----------------------------
function backFromFormMenu() {
    if (currentCategory === "daily10") {
        showMainMenu();
        return;
    }

    if (currentCategory === "regular") openRegularMenu();
    else if (currentCategory === "irregular") openIrregularMenu();

    else if (currentCategory === "presentRegular") openPresentRegular();
    else if (currentCategory === "presentIrregular") openPresentIrregular();

    else if (currentCategory === "pastRegular") openPastRegular();
    else if (currentCategory === "pastIrregular") openPastIrregular();
}

// -----------------------------
// BACK FROM EDITORS
// -----------------------------
function backFromEditor() {
    hideAll();

    if (editorTarget === "futureRegular") openRegularMenu();
    else if (editorTarget === "futureIrregular") openIrregularMenu();

    else if (editorTarget === "presentRegular") openPresentRegular();
    else if (editorTarget === "presentIrregular") openPresentIrregular();

    else if (editorTarget === "pastRegular") openPastRegular();
    else if (editorTarget === "pastIrregular") openPastIrregular();
}

// -----------------------------
// STUDY MODE
// -----------------------------
function startStudy() {
    if (!currentList || currentList.length === 0) {
        alert("No verbs in this set yet.");
        return;
    }

    hideAll();
    document.getElementById("studyTitle").textContent = "Study Mode";

    const container = document.getElementById("studyCards");
    container.innerHTML = "";

    currentList.forEach(item => {
        const card = document.createElement("div");
        card.className = "study-card";
        card.textContent = item.gaelic;
        card.dataset.state = "g";

        card.onclick = () => {
            if (card.dataset.state === "g") {
                card.textContent = item.english;
                card.dataset.state = "e";
            } else {
                card.textContent = item.gaelic;
                card.dataset.state = "g";
            }
        };

        container.appendChild(card);
    });

    document.getElementById("study").classList.remove("hidden");
}

function backFromStudyOrPlay() {
    if (savedForm !== null) {
        currentForm = savedForm;
        savedForm = null;
    }

    hideAll();
    document.getElementById("formMenu").classList.remove("hidden");
}


// -----------------------------
// PLAY MODE (MATCHING GAME)
// -----------------------------
let selectedGaelic = null;
let selectedEnglish = null;
let matches = 0;

function startGame() {
    if (!currentList || currentList.length === 0) {
        alert("No verbs in this set yet.");
        return;
    }

    hideAll();
    document.getElementById("playTitle").textContent = "Play Mode";

    matches = 0;
    selectedGaelic = null;
    selectedEnglish = null;
    document.getElementById("result").textContent = "";

    renderGame();
    document.getElementById("play").classList.remove("hidden");
}

function renderGame() {
    const gCol = document.getElementById("gaelicColumn");
    const eCol = document.getElementById("englishColumn");

    gCol.innerHTML = "<h3>Gaelic</h3>";
    eCol.innerHTML = "<h3>English</h3>";

    const gList = shuffle([...currentList]);
    const eList = shuffle([...currentList]);

    gList.forEach(item => {
        const div = document.createElement("div");
        div.className = "word";
        div.textContent = item.gaelic;
        div.dataset.gaelic = item.gaelic;
        div.dataset.english = item.english;
        div.onclick = () => selectGaelic(div);
        gCol.appendChild(div);
    });

    eList.forEach(item => {
        const div = document.createElement("div");
        div.className = "word";
        div.textContent = item.english;
        div.dataset.gaelic = item.gaelic;
        div.dataset.english = item.english;
        div.onclick = () => selectEnglish(div);
        eCol.appendChild(div);
    });
}

function selectGaelic(el) {
    if (selectedGaelic) selectedGaelic.classList.remove("selected");
    selectedGaelic = el;
    el.classList.add("selected");
    checkMatch();
}

function selectEnglish(el) {
    if (selectedEnglish) selectedEnglish.classList.remove("selected");
    selectedEnglish = el;
    el.classList.add("selected");
    checkMatch();
}

function checkMatch() {
    if (!selectedGaelic || !selectedEnglish) return;

    const gWord = selectedGaelic.dataset.gaelic;
    const eWord = selectedEnglish.dataset.english;

    // FIXED: Matching now uses ONLY currentList
    const correct = currentList.find(
        w => w.gaelic === gWord && w.english === eWord
    );

    if (correct) {
        selectedGaelic.style.background = "#c8f7c5";
        selectedEnglish.style.background = "#c8f7c5";
        selectedGaelic.onclick = null;
        selectedEnglish.onclick = null;
        matches++;

        if (matches === currentList.length) {
            document.getElementById("result").textContent =
                "Great job — you matched them all!";
        }
    } else {
        selectedGaelic.style.background = "#f7c5c5";
        selectedEnglish.style.background = "#f7c5c5";
        setTimeout(() => {
            selectedGaelic.style.background = "";
            selectedEnglish.style.background = "";
        }, 600);
    }

    selectedGaelic.classList.remove("selected");
    selectedEnglish.classList.remove("selected");
    selectedGaelic = null;
    selectedEnglish = null;
}

// -----------------------------
// TYPE THE ANSWER MODE
// -----------------------------
function startTypeAnswer() {
    savedForm = currentForm;
    
    if (currentForm !== "mixed") {
    setCurrentList();
    }


    typeIndex = 0;

    hideAll();
    document.getElementById("typeAnswer").classList.remove("hidden");

    showTypeQuestion();
}


function showTypeQuestion() {
    if (typeIndex >= currentList.length) {
        endTypeAnswer();
        return;
    }

    let item = currentList[typeIndex];

    document.getElementById("typePrompt").textContent = item.gaelic;
    document.getElementById("typeInput").value = "";
    document.getElementById("typeFeedback").textContent = "";
}

function submitTypedAnswer() {
    let item = currentList[typeIndex];
    let userAnswer = document.getElementById("typeInput").value.trim().toLowerCase();
    let correctAnswer = item.english.trim().toLowerCase();

    if (userAnswer === correctAnswer) {
        document.getElementById("typeFeedback").textContent = "Correct!";
    } else {
        document.getElementById("typeFeedback").textContent =
            "Incorrect. Correct answer: " + item.english;
    }

    typeIndex++;
    setTimeout(showTypeQuestion, 1200);
}

function endTypeAnswer() {
    hideAll();
    document.getElementById("typeAnswer").classList.remove("hidden");
    document.getElementById("typePrompt").textContent = "Well done!";
    document.getElementById("typeFeedback").textContent = "";
}



// -----------------------------
// PRESENT REGULAR EDITOR
// -----------------------------
function editPresentRegular() {
    editorTarget = "presentRegular";
    hideAll();

    const container = document.getElementById("presentRegularEditContainer");
    container.innerHTML = "";

    presentRegular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="pr_g${index}">
            <input type="text" value="${item.english}" id="pr_e${index}">
            <select id="pr_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deletePresentRegular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="pr_new_g" placeholder="New Gaelic verb">
        <input type="text" id="pr_new_e" placeholder="New English meaning">
        <select id="pr_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("presentRegularEditor").classList.remove("hidden");
}

function deletePresentRegular(index) {
    presentRegular.splice(index, 1);
    editPresentRegular();
}

function savePresentRegular() {
    const newList = [];

    presentRegular.forEach((item, index) => {
        const g = document.getElementById(`pr_g${index}`).value.trim();
        const e = document.getElementById(`pr_e${index}`).value.trim();
        const f = document.getElementById(`pr_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("pr_new_g").value.trim();
    const newE = document.getElementById("pr_new_e").value.trim();
    const newF = document.getElementById("pr_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    presentRegular = newList;
    backFromEditor();
}

// -----------------------------
// PRESENT IRREGULAR EDITOR
// -----------------------------
function editPresentIrregular() {
    editorTarget = "presentIrregular";
    hideAll();

    const container = document.getElementById("presentIrregularEditContainer");
    container.innerHTML = "";

    presentIrregular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="pi_g${index}">
            <input type="text" value="${item.english}" id="pi_e${index}">
            <select id="pi_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deletePresentIrregular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="pi_new_g" placeholder="New Gaelic verb">
        <input type="text" id="pi_new_e" placeholder="New English meaning">
        <select id="pi_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("presentIrregularEditor").classList.remove("hidden");
}

function deletePresentIrregular(index) {
    presentIrregular.splice(index, 1);
    editPresentIrregular();
}

function savePresentIrregular() {
    const newList = [];

    presentIrregular.forEach((item, index) => {
        const g = document.getElementById(`pi_g${index}`).value.trim();
        const e = document.getElementById(`pi_e${index}`).value.trim();
        const f = document.getElementById(`pi_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("pi_new_g").value.trim();
    const newE = document.getElementById("pi_new_e").value.trim();
    const newF = document.getElementById("pi_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    presentIrregular = newList;
    backFromEditor();
}

// -----------------------------
// PRESENT IRREGULAR EDITOR
// -----------------------------
function editPresentIrregular() {
    editorTarget = "presentIrregular";
    hideAll();

    const container = document.getElementById("presentIrregularEditContainer");
    container.innerHTML = "";

    presentIrregular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="pi_g${index}">
            <input type="text" value="${item.english}" id="pi_e${index}">
            <select id="pi_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deletePresentIrregular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="pi_new_g" placeholder="New Gaelic verb">
        <input type="text" id="pi_new_e" placeholder="New English meaning">
        <select id="pi_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("presentIrregularEditor").classList.remove("hidden");
}

function deletePresentIrregular(index) {
    presentIrregular.splice(index, 1);
    editPresentIrregular();
}

function savePresentIrregular() {
    const newList = [];

    presentIrregular.forEach((item, index) => {
        const g = document.getElementById(`pi_g${index}`).value.trim();
        const e = document.getElementById(`pi_e${index}`).value.trim();
        const f = document.getElementById(`pi_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("pi_new_g").value.trim();
    const newE = document.getElementById("pi_new_e").value.trim();
    const newF = document.getElementById("pi_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    presentIrregular = newList;
    backFromEditor();
}

// -----------------------------
// PAST REGULAR EDITOR
// -----------------------------
function editPastRegular() {
    editorTarget = "pastRegular";
    hideAll();

    const container = document.getElementById("pastRegularEditContainer");
    container.innerHTML = "";

    pastRegular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="prr_g${index}">
            <input type="text" value="${item.english}" id="prr_e${index}">
            <select id="prr_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deletePastRegular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="prr_new_g" placeholder="New Gaelic verb">
        <input type="text" id="prr_new_e" placeholder="New English meaning">
        <select id="prr_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("pastRegularEditor").classList.remove("hidden");
}

function deletePastRegular(index) {
    pastRegular.splice(index, 1);
    editPastRegular();
}

function savePastRegular() {
    const newList = [];

    pastRegular.forEach((item, index) => {
        const g = document.getElementById(`prr_g${index}`).value.trim();
        const e = document.getElementById(`prr_e${index}`).value.trim();
        const f = document.getElementById(`prr_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("prr_new_g").value.trim();
    const newE = document.getElementById("prr_new_e").value.trim();
    const newF = document.getElementById("prr_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    pastRegular = newList;
    backFromEditor();
}

// -----------------------------
// PAST IRREGULAR EDITOR
// -----------------------------
function editPastIrregular() {
    editorTarget = "pastIrregular";
    hideAll();

    const container = document.getElementById("pastIrregularEditContainer");
    container.innerHTML = "";

    pastIrregular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="pai_g${index}">
            <input type="text" value="${item.english}" id="pai_e${index}">
            <select id="pai_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deletePastIrregular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="pai_new_g" placeholder="New Gaelic verb">
        <input type="text" id="pai_new_e" placeholder="New English meaning">
        <select id="pai_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("pastIrregularEditor").classList.remove("hidden");
}

function deletePastIrregular(index) {
    pastIrregular.splice(index, 1);
    editPastIrregular();
}

function savePastIrregular() {
    const newList = [];

    pastIrregular.forEach((item, index) => {
        const g = document.getElementById(`pai_g${index}`).value.trim();
        const e = document.getElementById(`pai_e${index}`).value.trim();
        const f = document.getElementById(`pai_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("pai_new_g").value.trim();
    const newE = document.getElementById("pai_new_e").value.trim();
    const newF = document.getElementById("pai_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    pastIrregular = newList;
    backFromEditor();
}

// -----------------------------
// FUTURE REGULAR EDITOR
// -----------------------------
function editFutureRegular() {
    editorTarget = "futureRegular";
    hideAll();

    const container = document.getElementById("regularEditContainer");
    container.innerHTML = "";

    futureRegular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="fr_g${index}">
            <input type="text" value="${item.english}" id="fr_e${index}">
            <select id="fr_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deleteFutureRegular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="fr_new_g" placeholder="New Gaelic verb">
        <input type="text" id="fr_new_e" placeholder="New English meaning">
        <select id="fr_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

//    const editor = document.getElementById("futureRegularEditor");
// if (editor) editor.classList.remove("hidden");

    document.getElementById("regularEditor").classList.remove("hidden");
}

function deleteFutureRegular(index) {
    futureRegular.splice(index, 1);
    editFutureRegular();
}

function saveFutureRegular() {
    const newList = [];

    futureRegular.forEach((item, index) => {
        const g = document.getElementById(`fr_g${index}`).value.trim();
        const e = document.getElementById(`fr_e${index}`).value.trim();
        const f = document.getElementById(`fr_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("fr_new_g").value.trim();
    const newE = document.getElementById("fr_new_e").value.trim();
    const newF = document.getElementById("fr_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    futureRegular = newList;
    backFromEditor();
}

// -----------------------------
// FUTURE IRREGULAR EDITOR
// -----------------------------
function editFutureIrregular() {
    editorTarget = "futureIrregular";
    hideAll();

    const container = document.getElementById("irregularEditContainer");
    container.innerHTML = "";

    futureIrregular.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "edit-row";

        row.innerHTML = `
            <input type="text" value="${item.gaelic}" id="fi_g${index}">
            <input type="text" value="${item.english}" id="fi_e${index}">
            <select id="fi_f${index}">
                <option value="positive"${item.form === "positive" ? " selected" : ""}>positive</option>
                <option value="negative"${item.form === "negative" ? " selected" : ""}>negative</option>
                <option value="question"${item.form === "question" ? " selected" : ""}>question</option>
            </select>
            <button class="delete-btn" onclick="deleteFutureIrregular(${index})">X</button>
        `;

        container.appendChild(row);
    });

    const newRow = document.createElement("div");
    newRow.className = "edit-row";
    newRow.innerHTML = `
        <input type="text" id="fi_new_g" placeholder="New Gaelic verb">
        <input type="text" id="fi_new_e" placeholder="New English meaning">
        <select id="fi_new_f">
            <option value="positive">positive</option>
            <option value="negative">negative</option>
            <option value="question">question</option>
        </select>
    `;
    container.appendChild(newRow);

    document.getElementById("irregularEditor").classList.remove("hidden");
}

function deleteFutureIrregular(index) {
    futureIrregular.splice(index, 1);
    editFutureIrregular();
}

function saveFutureIrregular() {
    const newList = [];

    futureIrregular.forEach((item, index) => {
        const g = document.getElementById(`fi_g${index}`).value.trim();
        const e = document.getElementById(`fi_e${index}`).value.trim();
        const f = document.getElementById(`fi_f${index}`).value;

        if (g && e) newList.push({ gaelic: g, english: e, form: f });
    });

    const newG = document.getElementById("fi_new_g").value.trim();
    const newE = document.getElementById("fi_new_e").value.trim();
    const newF = document.getElementById("fi_new_f").value;

    if (newG && newE) newList.push({ gaelic: newG, english: newE, form: newF });

    futureIrregular = newList;
    backFromEditor();

}

